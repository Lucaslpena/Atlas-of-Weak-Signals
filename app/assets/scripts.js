/*!
 * aows
 * 
 * 
 * @author Lucas Lorenzo Pena <lucaslpena@gmail.com>
 * @version 0.1.0
 * Copyright 2019. CC-BY-NC-SA-4.0 licensed.
 */
function Attractor(weaksignal, xCord, yCord) {
  this.ws = weaksignal;
  var length = width - 2 * padding;
  var interval = length / grid;
  var centerX = padding + interval * (xCord + 1);
  centerX = centerX - interval / 2;
  length = height - 2 * padding;
  interval = length / grid;
  var centerY = padding + interval * (yCord + 1);
  centerY = centerY - interval / 2;
  this.pos = createVector(centerX, centerY);
  this.vel = createVector(0, 0);
  this.acc = createVector(0, 0);
  this.mass = 6;
  this.G = 20; //was 80

  this.scaler = 5;

  this.calculateAttraction = function (p) {
    //calculate direction of force
    var force = p5.Vector.sub(this.pos, p.pos);
    push();
    var opa = noise(p.offset) * 255; // console.log(opa);

    stroke(color(50, 50, 50, opa)); // stroke(255);

    line(this.pos.x, this.pos.y, p.pos.x, p.pos.y);
    pop(); //distance between objects

    var distance = force.mag(); //limit vector to eliminate extreme values at very close or very far
    // distance = constrain(distance,20,25);

    distance = constrain(distance, 50, 55); //Not really important but is what it is to get direction

    force.normalize(); //calculate gravitational from magniitude

    var strength = this.G * this.mass * p.mass / (distance * distance); //get force vector --> magnitude * direction

    force.mult(strength); //var force;

    return force;
  };

  this.applyForce = function (force) {
    // A = F /M
    var f = force.copy();
    f.div(this.mass);
    this.acc.add(f);
  };

  this.update = function () {
    this.edges();
    this.vel.add(this.acc);
    this.pos.add(this.vel);
    this.acc.set(0, 0);
  };

  this.display = function () {
    push(); // fill(30,25,20);

    stroke(30, 25, 30); // ellipse(this.pos.x, this.pos.y, this.mass * this.scaler, this.mass * this.scaler);
    // fill(30,25,20);

    textAlign(CENTER, CENTER); // text(this.ws, this.pos.x, this.pos.y);

    pop();
  };

  this.edges = function () {
    if (this.pos.y > height) {
      this.vel.y *= -1;
      this.pos = createVector(width / 2, height / 2);
      this.vel = createVector(0, 0);
    }

    if (this.pos.x > width) {
      this.vel.x *= -1;
      this.pos = createVector(width / 2, height / 2);
      this.vel = createVector(0, 0);
    }

    if (this.pos.x < 0) {
      this.vel.x *= -1;
      this.pos = createVector(width / 2, height / 2);
      this.vel = createVector(0, 0);
    }

    if (this.pos.y < 0) {
      this.vel.x *= -1;
      this.pos = createVector(width / 2, height / 2);
      this.vel = createVector(0, 0);
    }
  };
}
/*!
 * aows
 * 
 * 
 * @author Lucas Lorenzo Pena <lucaslpena@gmail.com>
 * @version 0.1.0
 * Copyright 2019. CC-BY-NC-SA-4.0 licensed.
 */
function Particle(x, y, a) {
  this.atlas = a;
  this.offset = randomIntFromInterval(0, 100) / 100;
  this.pos = createVector(x, y);
  this.vel = createVector(random(-3, 3), random(-3, 3));
  this.acc = createVector(0, -8); // this.vel = createVector(0,0);
  // this.acc = createVector(0,0);

  this.mass = 10;
  this.G = 5;
  this.previousVel = createVector(0, 0);
  this.maxSpeed = 3;
  this.theta = 0.0;
  this.size = 20; // this.maxForce = 1;

  this.history = [];

  this.update = function () {
    this.offset += 0.1; // console.log(this.offset);

    this.edges();
    this.vel.add(this.acc);
    this.vel.limit(this.maxSpeed);
    this.pos.add(this.vel);
    this.acc.set(0, 0);

    if (frameCount % 10 == 1) {
      var v = createVector(this.pos.x, this.pos.y);
      this.history.push(v);

      if (this.history.length > 8) {
        this.history.splice(0, 1);
      } // console.log(this.pos);
      // console.log("current ^ last v");
      // console.log(this.history);

    }
  };

  this.display = function () {
    this.trailing();
    var theta = this.vel.heading() + radians(90);
    this.theta += this.vel.x * this.vel.mag() / 20;
    var r = 4;
    push();
    translate(this.pos.x, this.pos.y); // rotate(this.theta);

    textAlign(CENTER, CENTER);
    textSize(12);
    stroke(255);
    fill(225);
    text(this.atlas.kw, 0, 0);
    pop();
  };

  this.trailing = function () {
    for (var i = 0; i < this.history.length; i++) {
      var pos = this.history[i];
      push();
      translate(pos.x, pos.y);
      stroke('#f2dd1c');
      fill(225);
      point(0, 0);
      pop();
    }
  };

  this.edges = function () {
    if (this.pos.x < -this.size) this.pos.x = width + this.size;
    if (this.pos.y < -this.size) this.pos.y = height + this.size;
    if (this.pos.x > width + this.size) this.pos.x = -this.size;
    if (this.pos.y > height + this.size) this.pos.y = -this.size;
  };

  this.separate = function (vehicles) {
    var desiredseparation = this.size * 1.1;
    var sum = createVector();
    var count = 0;

    for (var i = 0; i < vehicles.length; i++) {
      var d = p5.Vector.dist(this.pos, vehicles[i].pos);

      if (d > 0 && d < desiredseparation) {
        var diff = p5.Vector.sub(this.pos, vehicles[i].pos);
        diff.normalize();
        diff.div(d);
        sum.add(diff);
        count++;
      }
    }

    if (count > 0) {
      sum.div(count);
      sum.normalize();
      sum.mult(this.maxSpeed * 2);
      var steer = p5.Vector.sub(sum, this.velocity);
      steer.limit(this.maxforce);
      this.applyForce(steer);
    }
  };

  this.applyForce = function (force) {
    var f = force.copy();
    f.div(this.mass);
    this.acc.add(f);
  }; //calculate attraction


  this.calculateAttraction = function (obj) {
    //calculate direction of force
    var force = p5.Vector.sub(this.pos, obj.pos); //distance between objects

    var distance = force.mag(); //limit vector to eliminate extreme values at very close or very far
    //distance = constrain(distance,20,25);
    //Not really important but is what it is to get direction

    force.normalize(); //calculate gravitational from magniitude

    var strength = this.G * this.mass * obj.mass / (distance * distance); //get force vector --> magnitude * direction

    force.mult(strength); //var force;

    return force;
  };

  this.applyGravity = function () {
    for (var i = 0; i < attractors.length; i++) {
      var a = attractors[i];

      if (a.ws === this.atlas.ws) {
        //get everyone applied to and attract to it
        // console.log('attracted to: ' + a.ws);
        var f = a.calculateAttraction(this); // console.log(f);

        this.applyForce(f);
      }
    }
  };
}
/*!
 * aows
 * 
 * 
 * @author Lucas Lorenzo Pena <lucaslpena@gmail.com>
 * @version 0.1.0
 * Copyright 2019. CC-BY-NC-SA-4.0 licensed.
 */
// var text1 = new Blotter.Text("under construction üëÅ‚Äçüó®", {
//     family : "Overpass Mono",
//     size : 84,
//     fill : "#171717"
// });
//
// var text2 = new Blotter.Text("Sup", {
//     family : "Overpass Mono",
//     size : 120,
//     fill : "#171717"
// });
//
// var material = new Blotter.ChannelSplitMaterial();
//
// var blotter1 = new Blotter(material, { texts : text1 });
// var scope1 = blotter1.forText(text1);
// scope1.appendTo(document.body);
//
// // var blotter2 = new Blotter(material, { texts : text2 });
// // var scope2 = blotter2.forText(text2);
// // scope2.appendTo(document.body);
//
// setTimeout(function(){
//     var element = $('.b-canvas').detach();
//     // $('.s00').append(element);
// },2000);
//
// //https://codepen.io/SimonEvans/pen/PQKgyQ
// // https://github.com/bradley/blotter
// // https://blotter.js.org/#/documentation
/*!
 * aows
 * 
 * 
 * @author Lucas Lorenzo Pena <lucaslpena@gmail.com>
 * @version 0.1.0
 * Copyright 2019. CC-BY-NC-SA-4.0 licensed.
 */
function randomIntFromInterval(min, max) {
  //min max may be included
  return Math.floor(Math.random() * (max - min + 1) + min);
}

var particles = [];
var limit = 10;
var weaksignals = [];
var keywords = [];
var attractors = [];
var jsonData = {};
var padding = 100;
var grid = 5;

function preload() {
  var jsonFile = "../data/fromspreadsheet.json";
  jsonData = loadJSON(jsonFile);
  console.log(jsonData);
}

var cnv;

var atlasObj = function (weaksignal, keyword) {
  this.kw = keyword;
  this.ws = weaksignal;
};

function centerCanvas() {
  cnv = createCanvas(windowWidth, windowHeight);
  var x = (windowWidth - width) / 2;
  var y = (windowHeight - height) / 2;
  cnv.position(x, y);
}

function windowResized() {
  centerCanvas();
}

function setup() {
  centerCanvas();
  setupWeakSignals();
  textFont("Overpass Mono");
  frameRate(60);
  setupObjects();
}

function draw() {
  background('#000');
  clear();

  for (var i = 0; i < particles.length; i++) {
    particles[i].applyGravity(); // particles[i].separate(particles);
    // particles[i].separate(attractors);

    particles[i].update();
    particles[i].display();
  }

  textSize(14);
  fill(0);
  attractors.forEach(function (a) {
    a.update();
    a.display();
  });
}

function setupObjects() {
  weaksignals.forEach(function (ws, i) {
    keywords[i].forEach(function (kw, j) {
      var atls = new atlasObj(ws, kw);
      console.log(atls);
      particles.push(new Particle(random(50, width - 50), random(50, height - 50), {
        ws: ws,
        kw: kw
      }));
    });
  });
}

function setupWeakSignals() {
  //clipping keyword list to random selected words until wordCount reached
  for (var i in jsonData) {
    var wordCount = 5;
    var items, index, item;

    if (jsonData[i]["keywords"].length > wordCount) {
      var newItems = [];

      for (var j = 0; j < wordCount; j++) {
        items = jsonData[i]["keywords"];
        index = Math.floor(Math.random() * items.length);
        item = items.splice(index, 1);
        newItems.push(item[0]); // console.log(item[0]);
      }

      console.log(newItems);
      jsonData[i]["keywords"] = newItems.slice();
    }
  } // console.log(jsonData);
  // console.log('setup');
  // console.log(jsonData);


  var j = 0,
      k = 0;

  for (var i in jsonData) {
    console.log(j, k);
    attractors.push(new Attractor(jsonData[i]["name"], j, k));
    weaksignals.push(jsonData[i]["name"]);
    keywords.push(jsonData[i]["keywords"]);
    console.log('hit');
    $(".s" + j + k).html("<h1>" + jsonData[i]["name"] + "</h1>");

    if (j == grid - 1) {
      k++;
      j = -1;
    }

    j++;
  } // console.log(weaksignals)
  // 3 * 3 grid

}

function reInit() {
  particles.splice(0, particles.length);
  weaksignals.splice(0, weaksignals.length);
  keywords.splice(0, keywords.length);
  attractors.splice(0, attractors.length);
  setupWeakSignals();
  setupObjects();
}

setInterval(function () {
  reInit();
}, 60000 * 5);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF0dHJhY3Rvci5qcyIsInBhcnRpY2xlLmpzIiwic2NyaXB0LmpzIiwic2tldGNoLmpzIl0sIm5hbWVzIjpbIkF0dHJhY3RvciIsIndlYWtzaWduYWwiLCJ4Q29yZCIsInlDb3JkIiwid3MiLCJsZW5ndGgiLCJ3aWR0aCIsInBhZGRpbmciLCJpbnRlcnZhbCIsImdyaWQiLCJjZW50ZXJYIiwiaGVpZ2h0IiwiY2VudGVyWSIsInBvcyIsImNyZWF0ZVZlY3RvciIsInZlbCIsImFjYyIsIm1hc3MiLCJHIiwic2NhbGVyIiwiY2FsY3VsYXRlQXR0cmFjdGlvbiIsInAiLCJmb3JjZSIsInA1IiwiVmVjdG9yIiwic3ViIiwicHVzaCIsIm9wYSIsIm5vaXNlIiwib2Zmc2V0Iiwic3Ryb2tlIiwiY29sb3IiLCJsaW5lIiwieCIsInkiLCJwb3AiLCJkaXN0YW5jZSIsIm1hZyIsImNvbnN0cmFpbiIsIm5vcm1hbGl6ZSIsInN0cmVuZ3RoIiwibXVsdCIsImFwcGx5Rm9yY2UiLCJmIiwiY29weSIsImRpdiIsImFkZCIsInVwZGF0ZSIsImVkZ2VzIiwic2V0IiwiZGlzcGxheSIsInRleHRBbGlnbiIsIkNFTlRFUiIsIlBhcnRpY2xlIiwiYSIsImF0bGFzIiwicmFuZG9tSW50RnJvbUludGVydmFsIiwicmFuZG9tIiwicHJldmlvdXNWZWwiLCJtYXhTcGVlZCIsInRoZXRhIiwic2l6ZSIsImhpc3RvcnkiLCJsaW1pdCIsImZyYW1lQ291bnQiLCJ2Iiwic3BsaWNlIiwidHJhaWxpbmciLCJoZWFkaW5nIiwicmFkaWFucyIsInIiLCJ0cmFuc2xhdGUiLCJ0ZXh0U2l6ZSIsImZpbGwiLCJ0ZXh0Iiwia3ciLCJpIiwicG9pbnQiLCJzZXBhcmF0ZSIsInZlaGljbGVzIiwiZGVzaXJlZHNlcGFyYXRpb24iLCJzdW0iLCJjb3VudCIsImQiLCJkaXN0IiwiZGlmZiIsInN0ZWVyIiwidmVsb2NpdHkiLCJtYXhmb3JjZSIsIm9iaiIsImFwcGx5R3Jhdml0eSIsImF0dHJhY3RvcnMiLCJtaW4iLCJtYXgiLCJNYXRoIiwiZmxvb3IiLCJwYXJ0aWNsZXMiLCJ3ZWFrc2lnbmFscyIsImtleXdvcmRzIiwianNvbkRhdGEiLCJwcmVsb2FkIiwianNvbkZpbGUiLCJsb2FkSlNPTiIsImNvbnNvbGUiLCJsb2ciLCJjbnYiLCJhdGxhc09iaiIsImtleXdvcmQiLCJjZW50ZXJDYW52YXMiLCJjcmVhdGVDYW52YXMiLCJ3aW5kb3dXaWR0aCIsIndpbmRvd0hlaWdodCIsInBvc2l0aW9uIiwid2luZG93UmVzaXplZCIsInNldHVwIiwic2V0dXBXZWFrU2lnbmFscyIsInRleHRGb250IiwiZnJhbWVSYXRlIiwic2V0dXBPYmplY3RzIiwiZHJhdyIsImJhY2tncm91bmQiLCJjbGVhciIsImZvckVhY2giLCJqIiwiYXRscyIsIndvcmRDb3VudCIsIml0ZW1zIiwiaW5kZXgiLCJpdGVtIiwibmV3SXRlbXMiLCJzbGljZSIsImsiLCIkIiwiaHRtbCIsInJlSW5pdCIsInNldEludGVydmFsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLFNBQVNBLFNBQVQsQ0FBbUJDLFVBQW5CLEVBQStCQyxLQUEvQixFQUFzQ0MsS0FBdEMsRUFBNkM7QUFDekMsT0FBS0MsRUFBTCxHQUFVSCxVQUFWO0FBQ0EsTUFBSUksTUFBTSxHQUFHQyxLQUFLLEdBQUcsSUFBRUMsT0FBdkI7QUFDQSxNQUFJQyxRQUFRLEdBQUlILE1BQU0sR0FBR0ksSUFBekI7QUFDQSxNQUFJQyxPQUFPLEdBQUdILE9BQU8sR0FBR0MsUUFBUSxJQUFJTixLQUFLLEdBQUMsQ0FBVixDQUFoQztBQUNBUSxFQUFBQSxPQUFPLEdBQUdBLE9BQU8sR0FBR0YsUUFBUSxHQUFDLENBQTdCO0FBQ0FILEVBQUFBLE1BQU0sR0FBR00sTUFBTSxHQUFHLElBQUVKLE9BQXBCO0FBQ0FDLEVBQUFBLFFBQVEsR0FBSUgsTUFBTSxHQUFHSSxJQUFyQjtBQUNBLE1BQUlHLE9BQU8sR0FBR0wsT0FBTyxHQUFHQyxRQUFRLElBQUlMLEtBQUssR0FBQyxDQUFWLENBQWhDO0FB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QW9CeUIsVUFBVSxDQUFDdEYsTUFBL0I7QUFFQThHLEVBQUFBLGdCQUFnQjtBQUNoQkcsRUFBQUEsWUFBWTtBQUNmOztBQUdEaUIsV0FBVyxDQUFDLFlBQVU7QUFDbEJELEVBQUFBLE1BQU07QUFDVCxDQUZVLEVBRVIsUUFBUSxDQUZBLENBQVgiLCJmaWxlIjoic2NyaXB0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIEF0dHJhY3Rvcih3ZWFrc2lnbmFsLCB4Q29yZCwgeUNvcmQpIHtcbiAgICB0aGlzLndzID0gd2Vha3NpZ25hbDtcbiAgICB2YXIgbGVuZ3RoID0gd2lkdGggLSAyKnBhZGRpbmc7XG4gICAgdmFyIGludGVydmFsID0gKGxlbmd0aCAvIGdyaWQpO1xuICAgIHZhciBjZW50ZXJYID0gcGFkZGluZyArIGludGVydmFsICogKHhDb3JkKzEpO1xuICAgIGNlbnRlclggPSBjZW50ZXJYIC0gaW50ZXJ2YWwvMjtcbiAgICBsZW5ndGggPSBoZWlnaHQgLSAyKnBhZGRpbmc7XG4gICAgaW50ZXJ2YWwgPSAobGVuZ3RoIC8gZ3JpZCk7XG4gICAgdmFyIGNlbnRlclkgPSBwYWRkaW5nICsgaW50ZXJ2YWwgKiAoeUNvcmQrMSk7XG4gICAgY2VudGVyWSA9IGNlbnRlclkgLSBpbnRlcnZhbC8yO1xuXG4gICAgdGhpcy5wb3MgPSBjcmVhdGVWZWN0b3IoY2VudGVyWCwgY2VudGVyWSk7XG4gICAgdGhpcy52ZWwgPSBjcmVhdGVWZWN0b3IoMCwwKTtcbiAgICB0aGlzLmFjYyA9IGNyZWF0ZVZlY3RvcigwLDApO1xuXG4gICAgdGhpcy5tYXNzID0gNjtcbiAgICB0aGlzLkcgPSAyMDsgLy93YXMgODBcbiAgICB0aGlzLnNjYWxlciA9IDU7XG5cbiAgICB0aGlzLmNhbGN1bGF0ZUF0dHJhY3Rpb24gPSBmdW5jdGlvbihwKXtcbiAgICAgICAgLy9jYWxjdWxhdGUgZGlyZWN0aW9uIG9mIGZvcmNlXG4gICAgICAgIHZhciBmb3JjZSA9IHA1LlZlY3Rvci5zdWIodGhpcy5wb3MsIHAucG9zKTtcblxuXG5cbiAgICAgICAgcHVzaCgpO1xuICAgICAgICB2YXIgb3BhID0gbm9pc2UocC5vZmZzZXQpICogMjU1O1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhvcGEpO1xuXG4gICAgICAgIHN0cm9rZShjb2xvcig1MCw1MCw1MCxvcGEpKTtcbiAgICAgICAgLy8gc3Ryb2tlKDI1NSk7XG4gICAgICAgIGxpbmUodGhpcy5wb3MueCwgdGhpcy5wb3MueSwgcC5wb3MueCwgcC5wb3MueSk7XG4gICAgICAgIHBvcCgpO1xuXG4gICAgICAgIC8vZGlzdGFuY2UgYmV0d2VlbiBvYmplY3RzXG4gICAgICAgIHZhciBkaXN0YW5jZSA9IGZvcmNlLm1hZygpO1xuXG4gICAgICAgIC8vbGltaXQgdmVjdG9yIHRvIGVsaW1pbmF0ZSBleHRyZW1lIHZhbHVlcyBhdCB2ZXJ5IGNsb3NlIG9yIHZlcnkgZmFyXG4gICAgICAgIC8vIGRpc3RhbmNlID0gY29uc3RyYWluKGRpc3RhbmNlLDIwLDI1KTtcbiAgICAgICAgZGlzdGFuY2UgPSBjb25zdHJhaW4oZGlzdGFuY2UsNTAsNTUpO1xuICAgICAgICAvL05vdCByZWFsbHkgaW1wb3J0YW50IGJ1dCBpcyB3aGF0IGl0IGlzIHRvIGdldCBkaXJlY3Rpb25cbiAgICAgICAgZm9yY2Uubm9ybWFsaXplKCk7XG5cbiAgICAgICAgLy9jYWxjdWxhdGUgZ3Jhdml0YXRpb25hbCBmcm9tIG1hZ25paXR1ZGVcbiAgICAgICAgdmFyIHN0cmVuZ3RoID0gKHRoaXMuRyAqIHRoaXMubWFzcyAqIHAubWFzcykgLyAoZGlzdGFuY2UgKiBkaXN0YW5jZSk7XG5cbiAgICAgICAgLy9nZXQgZm9yY2UgdmVjdG9yIC0tPiBtYWduaXR1ZGUgKiBkaXJlY3Rpb25cbiAgICAgICAgZm9yY2UubXVsdChzdHJlbmd0aCk7XG4gICAgICAgIC8vdmFyIGZvcmNlO1xuICAgICAgICByZXR1cm4gZm9yY2U7XG4gICAgfVxuXG4gICAgdGhpcy5hcHBseUZvcmNlID0gZnVuY3Rpb24oZm9yY2Upe1xuICAgICAgICAvLyBBID0gRiAvTVxuICAgICAgICB2YXIgZiA9IGZvcmNlLmNvcHkoKTtcbiAgICAgICAgZi5kaXYodGhpcy5tYXNzKTtcbiAgICAgICAgdGhpcy5hY2MuYWRkKGYpO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5lZGdlcygpO1xuICAgICAgICB0aGlzLnZlbC5hZGQodGhpcy5hY2MpO1xuICAgICAgICB0aGlzLnBvcy5hZGQodGhpcy52ZWwpO1xuICAgICAgICB0aGlzLmFjYy5zZXQoMCwwKTtcbiAgICB9XG5cbiAgICB0aGlzLmRpc3BsYXkgPSBmdW5jdGlvbigpe1xuICAgICAgICBwdXNoKCk7XG4gICAgICAgIC8vIGZpbGwoMzAsMjUsMjApO1xuICAgICAgICBzdHJva2UoMzAsMjUsMzApO1xuICAgICAgICAvLyBlbGxpcHNlKHRoaXMucG9zLngsIHRoaXMucG9zLnksIHRoaXMubWFzcyAqIHRoaXMuc2NhbGVyLCB0aGlzLm1hc3MgKiB0aGlzLnNjYWxlcik7XG4gICAgICAgIC8vIGZpbGwoMzAsMjUsMjApO1xuICAgICAgICB0ZXh0QWxpZ24oQ0VOVEVSLCBDRU5URVIpO1xuICAgICAgICAvLyB0ZXh0KHRoaXMud3MsIHRoaXMucG9zLngsIHRoaXMucG9zLnkpO1xuICAgICAgICBwb3AoKTtcbiAgICB9XG5cbiAgICB0aGlzLmVkZ2VzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgaWYgKHRoaXMucG9zLnkgPiBoZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMudmVsLnkgKj0gLTE7XG4gICAgICAgICAgICB0aGlzLnBvcyA9IGNyZWF0ZVZlY3Rvcih3aWR0aC8yLCBoZWlnaHQvMik7XG4gICAgICAgICAgICB0aGlzLnZlbCA9IGNyZWF0ZVZlY3RvcigwLDApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBvcy54ID4gd2lkdGgpIHtcbiAgICAgICAgICAgIHRoaXMudmVsLnggKj0gLTE7XG4gICAgICAgICAgICB0aGlzLnBvcyA9IGNyZWF0ZVZlY3Rvcih3aWR0aC8yLCBoZWlnaHQvMik7XG4gICAgICAgICAgICB0aGlzLnZlbCA9IGNyZWF0ZVZlY3RvcigwLDApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBvcy54IDwgMCkge1xuICAgICAgICAgICAgdGhpcy52ZWwueCAqPSAtMTtcbiAgICAgICAgICAgIHRoaXMucG9zID0gY3JlYXRlVmVjdG9yKHdpZHRoLzIsIGhlaWdodC8yKTtcbiAgICAgICAgICAgIHRoaXMudmVsID0gY3JlYXRlVmVjdG9yKDAsMCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucG9zLnkgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLnZlbC54ICo9IC0xO1xuICAgICAgICAgICAgdGhpcy5wb3MgPSBjcmVhdGVWZWN0b3Iod2lkdGgvMiwgaGVpZ2h0LzIpO1xuICAgICAgICAgICAgdGhpcy52ZWwgPSBjcmVhdGVWZWN0b3IoMCwwKTtcbiAgICAgICAgfVxuICAgIH1cblxufSIsImZ1bmN0aW9uIFBhcnRpY2xlKHgseSxhKXtcbiAgICB0aGlzLmF0bGFzID0gYTtcblxuICAgIHRoaXMub2Zmc2V0ID0gcmFuZG9tSW50RnJvbUludGVydmFsKDAsMTAwKS8xMDA7XG5cblxuXG4gICAgdGhpcy5wb3MgPSBjcmVhdGVWZWN0b3IoeCwgeSk7XG4gICAgdGhpcy52ZWwgPSBjcmVhdGVWZWN0b3IocmFuZG9tKC0zLDMpLHJhbmRvbSgtMywzKSk7XG4gICAgdGhpcy5hY2MgPSBjcmVhdGVWZWN0b3IoMCwtOCk7XG5cbiAgICAvLyB0aGlzLnZlbCA9IGNyZWF0ZVZlY3RvcigwLDApO1xuICAgIC8vIHRoaXMuYWNjID0gY3JlYXRlVmVjdG9yKDAsMCk7XG5cbiAgICB0aGlzLm1hc3MgPSAxMDtcbiAgICB0aGlzLkcgPSA1O1xuICAgIHRoaXMucHJldmlvdXNWZWwgPSBjcmVhdGVWZWN0b3IoMCwwKTtcbiAgICB0aGlzLm1heFNwZWVkID0gMztcblxuICAgIHRoaXMudGhldGEgPSAwLjA7XG4gICAgdGhpcy5zaXplID0gMjA7XG4gICAgLy8gdGhpcy5tYXhGb3JjZSA9IDE7XG5cbiAgICB0aGlzLmhpc3RvcnkgPSBbXTtcblxuXG4gICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbigpe1xuICAgICAgICB0aGlzLm9mZnNldCArPSAwLjE7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMub2Zmc2V0KTtcbiAgICAgICAgdGhpcy5lZGdlcygpO1xuICAgICAgICB0aGlzLnZlbC5hZGQodGhpcy5hY2MpO1xuICAgICAgICB0aGlzLnZlbC5saW1pdCh0aGlzLm1heFNwZWVkKTtcbiAgICAgICAgdGhpcy5wb3MuYWRkKHRoaXMudmVsKTtcbiAgICAgICAgdGhpcy5hY2Muc2V0KDAsMCk7XG5cblxuICAgICAgICBpZiAoZnJhbWVDb3VudCAlIDEwID09IDEpe1xuICAgICAgICAgICAgdmFyIHYgPSBjcmVhdGVWZWN0b3IodGhpcy5wb3MueCwgdGhpcy5wb3MueSk7XG4gICAgICAgICAgICB0aGlzLmhpc3RvcnkucHVzaCh2KTtcbiAgICAgICAgICAgIGlmICh0aGlzLmhpc3RvcnkubGVuZ3RoID4gOCl7XG4gICAgICAgICAgICAgICAgdGhpcy5oaXN0b3J5LnNwbGljZSgwLDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5wb3MpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJjdXJyZW50IF4gbGFzdCB2XCIpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5oaXN0b3J5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZGlzcGxheSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMudHJhaWxpbmcoKTtcbiAgICAgICAgdmFyIHRoZXRhID0gdGhpcy52ZWwuaGVhZGluZygpICsgcmFkaWFucyg5MCk7XG4gICAgICAgIHRoaXMudGhldGEgKz0gKHRoaXMudmVsLnggKiB0aGlzLnZlbC5tYWcoKSkgLyAyMDtcbiAgICAgICAgdmFyIHIgPSA0O1xuICAgICAgICBwdXNoKCk7XG4gICAgICAgIHRyYW5zbGF0ZSh0aGlzLnBvcy54LCB0aGlzLnBvcy55KTtcbiAgICAgICAgLy8gcm90YXRlKHRoaXMudGhldGEpO1xuICAgICAgICB0ZXh0QWxpZ24oQ0VOVEVSLCBDRU5URVIpO1xuICAgICAgICB0ZXh0U2l6ZSgxMik7XG4gICAgICAgIHN0cm9rZSgyNTUpO1xuICAgICAgICBmaWxsKDIyNSk7XG4gICAgICAgIHRleHQodGhpcy5hdGxhcy5rdywgMCwwKTtcbiAgICAgICAgcG9wKCk7XG4gICAgfVxuXG4gICAgdGhpcy50cmFpbGluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5oaXN0b3J5Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIHZhciBwb3MgPSB0aGlzLmhpc3RvcnlbaV07XG4gICAgICAgICAgICBwdXNoKCk7XG4gICAgICAgICAgICB0cmFuc2xhdGUocG9zLngsIHBvcy55KTtcbiAgICAgICAgICAgIHN0cm9rZSgnI2YyZGQxYycpO1xuICAgICAgICAgICAgZmlsbCgyMjUpO1xuXG4gICAgICAgICAgICBwb2ludCgwLDApO1xuICAgICAgICAgICAgcG9wKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmVkZ2VzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgaWYgKHRoaXMucG9zLnggPCAtdGhpcy5zaXplKSB0aGlzLnBvcy54ID0gd2lkdGgrdGhpcy5zaXplO1xuICAgICAgICBpZiAodGhpcy5wb3MueSA8IC10aGlzLnNpemUpIHRoaXMucG9zLnkgPSBoZWlnaHQrdGhpcy5zaXplO1xuICAgICAgICBpZiAodGhpcy5wb3MueCA+IHdpZHRoK3RoaXMuc2l6ZSkgdGhpcy5wb3MueCA9IC10aGlzLnNpemU7XG4gICAgICAgIGlmICh0aGlzLnBvcy55ID4gaGVpZ2h0K3RoaXMuc2l6ZSkgdGhpcy5wb3MueSA9IC10aGlzLnNpemU7XG4gICAgfVxuXG4gICAgdGhpcy5zZXBhcmF0ZSA9IGZ1bmN0aW9uKHZlaGljbGVzKSB7XG4gICAgICAgIHZhciBkZXNpcmVkc2VwYXJhdGlvbiA9IHRoaXMuc2l6ZSoxLjE7XG4gICAgICAgIHZhciBzdW0gPSBjcmVhdGVWZWN0b3IoKTtcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2ZWhpY2xlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGQgPSBwNS5WZWN0b3IuZGlzdCh0aGlzLnBvcywgdmVoaWNsZXNbaV0ucG9zKTtcbiAgICAgICAgICAgIGlmICgoZCA+IDApICYmIChkIDwgZGVzaXJlZHNlcGFyYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpZmYgPSBwNS5WZWN0b3Iuc3ViKHRoaXMucG9zLCB2ZWhpY2xlc1tpXS5wb3MpO1xuICAgICAgICAgICAgICAgIGRpZmYubm9ybWFsaXplKCk7XG4gICAgICAgICAgICAgICAgZGlmZi5kaXYoZCk7XG4gICAgICAgICAgICAgICAgc3VtLmFkZChkaWZmKTtcbiAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChjb3VudCA+IDApIHtcbiAgICAgICAgICAgIHN1bS5kaXYoY291bnQpO1xuICAgICAgICAgICAgc3VtLm5vcm1hbGl6ZSgpO1xuICAgICAgICAgICAgc3VtLm11bHQodGhpcy5tYXhTcGVlZCAqIDIpO1xuICAgICAgICAgICAgdmFyIHN0ZWVyID0gcDUuVmVjdG9yLnN1YihzdW0sIHRoaXMudmVsb2NpdHkpO1xuICAgICAgICAgICAgc3RlZXIubGltaXQodGhpcy5tYXhmb3JjZSk7XG4gICAgICAgICAgICB0aGlzLmFwcGx5Rm9yY2Uoc3RlZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5hcHBseUZvcmNlID0gZnVuY3Rpb24oZm9yY2UpIHtcbiAgICAgICAgdmFyIGYgPSBmb3JjZS5jb3B5KCk7XG4gICAgICAgIGYuZGl2KHRoaXMubWFzcyk7XG4gICAgICAgIHRoaXMuYWNjLmFkZChmKTtcbiAgICB9XG5cbiAgICAvL2NhbGN1bGF0ZSBhdHRyYWN0aW9uXG4gICAgdGhpcy5jYWxjdWxhdGVBdHRyYWN0aW9uID0gZnVuY3Rpb24ob2JqKXtcbiAgICAgICAgLy9jYWxjdWxhdGUgZGlyZWN0aW9uIG9mIGZvcmNlXG4gICAgICAgIHZhciBmb3JjZSA9IHA1LlZlY3Rvci5zdWIodGhpcy5wb3MsIG9iai5wb3MpO1xuXG4gICAgICAgIC8vZGlzdGFuY2UgYmV0d2VlbiBvYmplY3RzXG4gICAgICAgIHZhciBkaXN0YW5jZSA9IGZvcmNlLm1hZygpO1xuICAgICAgICAvL2xpbWl0IHZlY3RvciB0byBlbGltaW5hdGUgZXh0cmVtZSB2YWx1ZXMgYXQgdmVyeSBjbG9zZSBvciB2ZXJ5IGZhclxuICAgICAgICAvL2Rpc3RhbmNlID0gY29uc3RyYWluKGRpc3RhbmNlLDIwLDI1KTtcbiAgICAgICAgLy9Ob3QgcmVhbGx5IGltcG9ydGFudCBidXQgaXMgd2hhdCBpdCBpcyB0byBnZXQgZGlyZWN0aW9uXG4gICAgICAgIGZvcmNlLm5vcm1hbGl6ZSgpO1xuXG4gICAgICAgIC8vY2FsY3VsYXRlIGdyYXZpdGF0aW9uYWwgZnJvbSBtYWduaWl0dWRlXG4gICAgICAgIHZhciBzdHJlbmd0aCA9ICh0aGlzLkcgKiB0aGlzLm1hc3MgKiBvYmoubWFzcykgLyAoZGlzdGFuY2UgKiBkaXN0YW5jZSk7XG5cbiAgICAgICAgLy9nZXQgZm9yY2UgdmVjdG9yIC0tPiBtYWduaXR1ZGUgKiBkaXJlY3Rpb25cbiAgICAgICAgZm9yY2UubXVsdChzdHJlbmd0aCk7XG4gICAgICAgIC8vdmFyIGZvcmNlO1xuICAgICAgICByZXR1cm4gZm9yY2U7XG4gICAgfVxuXG4gICAgdGhpcy5hcHBseUdyYXZpdHkgPSBmdW5jdGlvbigpe1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGF0dHJhY3RvcnMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgdmFyIGEgPSBhdHRyYWN0b3JzW2ldO1xuICAgICAgICAgICAgaWYgKGEud3MgPT09IHRoaXMuYXRsYXMud3MpeyAvL2dldCBldmVyeW9uZSBhcHBsaWVkIHRvIGFuZCBhdHRyYWN0IHRvIGl0XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2F0dHJhY3RlZCB0bzogJyArIGEud3MpO1xuICAgICAgICAgICAgICAgIHZhciBmID0gYS5jYWxjdWxhdGVBdHRyYWN0aW9uKHRoaXMpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGYpO1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlGb3JjZShmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufVxuIiwiLy8gdmFyIHRleHQxID0gbmV3IEJsb3R0ZXIuVGV4dChcInVuZGVyIGNvbnN0cnVjdGlvbiDwn5GB4oCN8J+XqFwiLCB7XG4vLyAgICAgZmFtaWx5IDogXCJPdmVycGFzcyBNb25vXCIsXG4vLyAgICAgc2l6ZSA6IDg0LFxuLy8gICAgIGZpbGwgOiBcIiMxNzE3MTdcIlxuLy8gfSk7XG4vL1xuLy8gdmFyIHRleHQyID0gbmV3IEJsb3R0ZXIuVGV4dChcIlN1cFwiLCB7XG4vLyAgICAgZmFtaWx5IDogXCJPdmVycGFzcyBNb25vXCIsXG4vLyAgICAgc2l6ZSA6IDEyMCxcbi8vICAgICBmaWxsIDogXCIjMTcxNzE3XCJcbi8vIH0pO1xuLy9cbi8vIHZhciBtYXRlcmlhbCA9IG5ldyBCbG90dGVyLkNoYW5uZWxTcGxpdE1hdGVyaWFsKCk7XG4vL1xuLy8gdmFyIGJsb3R0ZXIxID0gbmV3IEJsb3R0ZXIobWF0ZXJpYWwsIHsgdGV4dHMgOiB0ZXh0MSB9KTtcbi8vIHZhciBzY29wZTEgPSBibG90dGVyMS5mb3JUZXh0KHRleHQxKTtcbi8vIHNjb3BlMS5hcHBlbmRUbyhkb2N1bWVudC5ib2R5KTtcbi8vXG4vLyAvLyB2YXIgYmxvdHRlcjIgPSBuZXcgQmxvdHRlcihtYXRlcmlhbCwgeyB0ZXh0cyA6IHRleHQyIH0pO1xuLy8gLy8gdmFyIHNjb3BlMiA9IGJsb3R0ZXIyLmZvclRleHQodGV4dDIpO1xuLy8gLy8gc2NvcGUyLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpO1xuLy9cbi8vIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbi8vICAgICB2YXIgZWxlbWVudCA9ICQoJy5iLWNhbnZhcycpLmRldGFjaCgpO1xuLy8gICAgIC8vICQoJy5zMDAnKS5hcHBlbmQoZWxlbWVudCk7XG4vLyB9LDIwMDApO1xuLy9cbi8vIC8vaHR0cHM6Ly9jb2RlcGVuLmlvL1NpbW9uRXZhbnMvcGVuL1BRS2d5UVxuLy8gLy8gaHR0cHM6Ly9naXRodWIuY29tL2JyYWRsZXkvYmxvdHRlclxuLy8gLy8gaHR0cHM6Ly9ibG90dGVyLmpzLm9yZy8jL2RvY3VtZW50YXRpb24iLCJmdW5jdGlvbiByYW5kb21JbnRGcm9tSW50ZXJ2YWwobWluLG1heCl7IC8vbWluIG1heCBtYXkgYmUgaW5jbHVkZWRcbiAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihtYXgtbWluKzEpK21pbik7XG59XG5cblxudmFyIHBhcnRpY2xlcyA9IFtdO1xudmFyIGxpbWl0ID0gMTA7XG52YXIgd2Vha3NpZ25hbHMgPSBbXTtcbnZhciBrZXl3b3JkcyA9IFtdO1xudmFyIGF0dHJhY3RvcnMgPSBbXTtcbnZhciBqc29uRGF0YSA9IHt9O1xudmFyIHBhZGRpbmcgPSAxMDA7XG52YXIgZ3JpZCA9IDU7XG5cblxuZnVuY3Rpb24gcHJlbG9hZCgpIHtcbiAgICB2YXIganNvbkZpbGUgPSBcIi4uL2RhdGEvZnJvbXNwcmVhZHNoZWV0Lmpzb25cIjtcbiAgICBqc29uRGF0YSA9IGxvYWRKU09OKGpzb25GaWxlKTtcbiAgICBjb25zb2xlLmxvZyhqc29uRGF0YSk7XG59XG5cbnZhciBjbnY7XG5cblxudmFyIGF0bGFzT2JqID0gZnVuY3Rpb24od2Vha3NpZ25hbCwga2V5d29yZCl7XG4gICAgdGhpcy5rdyA9IGtleXdvcmQ7XG4gICAgdGhpcy53cyA9IHdlYWtzaWduYWw7XG59O1xuXG5mdW5jdGlvbiBjZW50ZXJDYW52YXMoKSB7XG4gICAgY252ID0gY3JlYXRlQ2FudmFzKHdpbmRvd1dpZHRoLCB3aW5kb3dIZWlnaHQpO1xuICAgIHZhciB4ID0gKHdpbmRvd1dpZHRoIC0gd2lkdGgpIC8gMjtcbiAgICB2YXIgeSA9ICh3aW5kb3dIZWlnaHQgLSBoZWlnaHQpIC8gMjtcbiAgICBjbnYucG9zaXRpb24oeCwgeSk7XG59XG5cbmZ1bmN0aW9uIHdpbmRvd1Jlc2l6ZWQoKSB7XG4gICAgY2VudGVyQ2FudmFzKCk7XG59XG5cbmZ1bmN0aW9uIHNldHVwKCkge1xuICAgIGNlbnRlckNhbnZhcygpO1xuICAgIHNldHVwV2Vha1NpZ25hbHMoKTtcbiAgICB0ZXh0Rm9udChcIk92ZXJwYXNzIE1vbm9cIik7XG4gICAgZnJhbWVSYXRlKDYwKTtcbiAgICBzZXR1cE9iamVjdHMoKTtcbn1cblxuZnVuY3Rpb24gZHJhdygpIHtcbiAgICBiYWNrZ3JvdW5kKCcjMDAwJyk7XG4gICAgY2xlYXIoKTtcblxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJ0aWNsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgcGFydGljbGVzW2ldLmFwcGx5R3Jhdml0eSgpO1xuICAgICAgICAvLyBwYXJ0aWNsZXNbaV0uc2VwYXJhdGUocGFydGljbGVzKTtcbiAgICAgICAgLy8gcGFydGljbGVzW2ldLnNlcGFyYXRlKGF0dHJhY3RvcnMpO1xuICAgICAgICBwYXJ0aWNsZXNbaV0udXBkYXRlKCk7XG4gICAgICAgIHBhcnRpY2xlc1tpXS5kaXNwbGF5KCk7XG4gICAgfVxuXG4gICAgdGV4dFNpemUoMTQpO1xuICAgIGZpbGwoMCk7XG4gICAgYXR0cmFjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGEpe1xuICAgICAgICBhLnVwZGF0ZSgpO1xuICAgICAgICBhLmRpc3BsYXkoKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gc2V0dXBPYmplY3RzKCl7XG4gICAgd2Vha3NpZ25hbHMuZm9yRWFjaChmdW5jdGlvbih3cywgaSl7XG4gICAgICAgIGtleXdvcmRzW2ldLmZvckVhY2goZnVuY3Rpb24oa3csIGope1xuICAgICAgICAgICAgdmFyIGF0bHMgPSBuZXcgYXRsYXNPYmood3MsIGt3KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGF0bHMpO1xuICAgICAgICAgICAgcGFydGljbGVzLnB1c2gobmV3IFBhcnRpY2xlKHJhbmRvbSg1MCwgd2lkdGggLSA1MCksIHJhbmRvbSg1MCwgaGVpZ2h0IC0gNTApLCB7d3M6d3MsIGt3Omt3fSkpO1xuICAgICAgICB9KTtcbiAgICB9KVxufVxuXG5mdW5jdGlvbiBzZXR1cFdlYWtTaWduYWxzKCl7XG5cbiAgICAvL2NsaXBwaW5nIGtleXdvcmQgbGlzdCB0byByYW5kb20gc2VsZWN0ZWQgd29yZHMgdW50aWwgd29yZENvdW50IHJlYWNoZWRcbiAgICBmb3IgKHZhciBpIGluIGpzb25EYXRhKXtcbiAgICAgICAgdmFyIHdvcmRDb3VudCA9IDU7XG4gICAgICAgIHZhciBpdGVtcywgaW5kZXgsIGl0ZW07XG4gICAgICAgIGlmIChqc29uRGF0YVtpXVtcImtleXdvcmRzXCJdLmxlbmd0aCA+IHdvcmRDb3VudCkge1xuICAgICAgICAgICAgdmFyIG5ld0l0ZW1zID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHdvcmRDb3VudDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaXRlbXMgPSBqc29uRGF0YVtpXVtcImtleXdvcmRzXCJdO1xuICAgICAgICAgICAgICAgIGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogaXRlbXMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBpdGVtID0gaXRlbXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICBuZXdJdGVtcy5wdXNoKGl0ZW1bMF0pO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGl0ZW1bMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2cobmV3SXRlbXMpO1xuICAgICAgICAgICAganNvbkRhdGFbaV1bXCJrZXl3b3Jkc1wiXSA9IG5ld0l0ZW1zLnNsaWNlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gY29uc29sZS5sb2coanNvbkRhdGEpO1xuXG5cbiAgICAvLyBjb25zb2xlLmxvZygnc2V0dXAnKTtcbiAgICAvLyBjb25zb2xlLmxvZyhqc29uRGF0YSk7XG5cbiAgICB2YXIgaiA9IDAsIGsgPSAwO1xuICAgIGZvciAodmFyIGkgaW4ganNvbkRhdGEpe1xuICAgICAgICBjb25zb2xlLmxvZyhqLGspO1xuICAgICAgICBhdHRyYWN0b3JzLnB1c2gobmV3IEF0dHJhY3Rvcihqc29uRGF0YVtpXVtcIm5hbWVcIl0sIGosIGspKTtcbiAgICAgICAgd2Vha3NpZ25hbHMucHVzaChqc29uRGF0YVtpXVtcIm5hbWVcIl0pO1xuICAgICAgICBrZXl3b3Jkcy5wdXNoKGpzb25EYXRhW2ldW1wia2V5d29yZHNcIl0pO1xuICAgICAgICBjb25zb2xlLmxvZygnaGl0Jyk7XG4gICAgICAgICQoKFwiLnNcIiArIGopK2spLmh0bWwoXCI8aDE+XCIranNvbkRhdGFbaV1bXCJuYW1lXCJdICtcIjwvaDE+XCIpO1xuICAgICAgICBpZiAoaiA9PSAoZ3JpZC0xKSl7XG4gICAgICAgICAgICBrKys7XG4gICAgICAgICAgICBqID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgaisrO1xuICAgIH1cblxuICAgIC8vIGNvbnNvbGUubG9nKHdlYWtzaWduYWxzKVxuICAgIC8vIDMgKiAzIGdyaWRcbn1cblxuZnVuY3Rpb24gcmVJbml0KCl7XG4gICAgcGFydGljbGVzLnNwbGljZSgwLHBhcnRpY2xlcy5sZW5ndGgpO1xuICAgIHdlYWtzaWduYWxzLnNwbGljZSgwLHdlYWtzaWduYWxzLmxlbmd0aCk7XG4gICAga2V5d29yZHMuc3BsaWNlKDAsa2V5d29yZHMubGVuZ3RoKTtcbiAgICBhdHRyYWN0b3JzLnNwbGljZSgwLGF0dHJhY3RvcnMubGVuZ3RoKTtcblxuICAgIHNldHVwV2Vha1NpZ25hbHMoKTtcbiAgICBzZXR1cE9iamVjdHMoKTtcbn1cblxuXG5zZXRJbnRlcnZhbChmdW5jdGlvbigpe1xuICAgIHJlSW5pdCgpO1xufSwgNjAwMDAgKiA1KTsiXX0=
