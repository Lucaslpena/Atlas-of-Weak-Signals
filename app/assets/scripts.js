/*!
 * aows
 * 
 * 
 * @author Lucas Lorenzo Pena <lucaslpena@gmail.com>
 * @version 0.1.0
 * Copyright 2019. CC-BY-NC-SA-4.0 licensed.
 */
function Attractor(weaksignal, xCord, yCord) {
  this.ws = weaksignal;
  var length = width - 2 * padding;
  var interval = length / grid;
  var centerX = padding + interval * (xCord + 1);
  centerX = centerX - interval / 2;
  length = height - 2 * padding;
  interval = length / grid;
  var centerY = padding + interval * (yCord + 1);
  centerY = centerY - interval / 2;
  this.pos = createVector(centerX, centerY);
  this.vel = createVector(0, 0);
  this.acc = createVector(0, 0);
  this.mass = 6;
  this.G = 15; //was 80

  this.scaler = 5;

  this.calculateAttraction = function (p) {
    //calculate direction of force
    var force = p5.Vector.sub(this.pos, p.pos); //distance between objects

    var distance = force.mag(); //limit vector to eliminate extreme values at very close or very far
    // distance = constrain(distance,20,25);

    distance = constrain(distance, 50, 55); //Not really important but is what it is to get direction

    force.normalize(); //calculate gravitational from magniitude

    var strength = this.G * this.mass * p.mass / (distance * distance); //get force vector --> magnitude * direction

    force.mult(strength); //var force;

    return force;
  };

  this.applyForce = function (force) {
    // A = F /M
    var f = force.copy();
    f.div(this.mass);
    this.acc.add(f);
  };

  this.update = function () {
    this.edges();
    this.vel.add(this.acc);
    this.pos.add(this.vel);
    this.acc.set(0, 0);
  };

  this.display = function () {
    push(); // fill(30,25,20);

    stroke(30, 25, 30); // ellipse(this.pos.x, this.pos.y, this.mass * this.scaler, this.mass * this.scaler);
    // fill(30,25,20);

    textAlign(CENTER, CENTER);
    text(this.ws, this.pos.x, this.pos.y);
    pop();
  };

  this.edges = function () {
    if (this.pos.y > height) {
      this.vel.y *= -1;
      this.pos = createVector(width / 2, height / 2);
      this.vel = createVector(0, 0);
    }

    if (this.pos.x > width) {
      this.vel.x *= -1;
      this.pos = createVector(width / 2, height / 2);
      this.vel = createVector(0, 0);
    }

    if (this.pos.x < 0) {
      this.vel.x *= -1;
      this.pos = createVector(width / 2, height / 2);
      this.vel = createVector(0, 0);
    }

    if (this.pos.y < 0) {
      this.vel.x *= -1;
      this.pos = createVector(width / 2, height / 2);
      this.vel = createVector(0, 0);
    }
  };
}
/*!
 * aows
 * 
 * 
 * @author Lucas Lorenzo Pena <lucaslpena@gmail.com>
 * @version 0.1.0
 * Copyright 2019. CC-BY-NC-SA-4.0 licensed.
 */
function Particle(x, y, a) {
  this.atlas = a;
  this.pos = createVector(x, y);
  this.vel = createVector(random(-3, 3), random(-3, 3));
  this.acc = createVector(0, -8); // this.vel = createVector(0,0);
  // this.acc = createVector(0,0);

  this.mass = 10;
  this.G = 5;
  this.previousVel = createVector(0, 0);
  this.maxSpeed = 3;
  this.theta = 0.0;
  this.size = 20; // this.maxForce = 1;

  this.spawn = function () {};

  this.update = function () {
    // this.spawn();
    this.edges();
    this.vel.add(this.acc);
    this.vel.limit(this.maxSpeed);
    this.pos.add(this.vel);
    this.acc.set(0, 0);
  };

  this.display = function () {
    var theta = this.vel.heading() + radians(90);
    this.theta += this.vel.x * this.vel.mag() / 20;
    var r = 4;
    push();
    translate(this.pos.x, this.pos.y); // rotate(this.theta);
    // rect(0,0,this.size,this.size);

    textAlign(CENTER, CENTER);
    textSize(15);
    text(this.atlas.kw, 0, 0); // if (this.paused) { //paused
    //print('paused');
    //print('frozen');
    // this.paused = false;
    // this.frozen = true;
    // this.img.pause();
    // }
    // if (this.img.loaded()){
    //   image(this.img, this.size/-2, this.size/-2, this.size, this.size);
    // }

    pop();
  };

  this.edges = function () {
    if (this.pos.x < -this.size) this.pos.x = width + this.size;
    if (this.pos.y < -this.size) this.pos.y = height + this.size;
    if (this.pos.x > width + this.size) this.pos.x = -this.size;
    if (this.pos.y > height + this.size) this.pos.y = -this.size;
  };

  this.separate = function (vehicles) {
    var desiredseparation = this.size * 1.1;
    var sum = createVector();
    var count = 0;

    for (var i = 0; i < vehicles.length; i++) {
      var d = p5.Vector.dist(this.pos, vehicles[i].pos);

      if (d > 0 && d < desiredseparation) {
        var diff = p5.Vector.sub(this.pos, vehicles[i].pos);
        diff.normalize();
        diff.div(d);
        sum.add(diff);
        count++;
      }
    }

    if (count > 0) {
      sum.div(count);
      sum.normalize();
      sum.mult(this.maxSpeed * 2);
      var steer = p5.Vector.sub(sum, this.velocity);
      steer.limit(this.maxforce);
      this.applyForce(steer);
    }
  };

  this.applyForce = function (force) {
    var f = force.copy();
    f.div(this.mass);
    this.acc.add(f);
  }; //calculate attraction


  this.calculateAttraction = function (obj) {
    //calculate direction of force
    var force = p5.Vector.sub(this.pos, obj.pos); //distance between objects

    var distance = force.mag(); //limit vector to eliminate extreme values at very close or very far
    //distance = constrain(distance,20,25);
    //Not really important but is what it is to get direction

    force.normalize(); //calculate gravitational from magniitude

    var strength = this.G * this.mass * obj.mass / (distance * distance); //get force vector --> magnitude * direction

    force.mult(strength); //var force;

    return force;
  };

  this.applyGravity = function () {
    for (var i = 0; i < attractors.length; i++) {
      var a = attractors[i];

      if (a.ws === this.atlas.ws) {
        //get everyone applied to and attract to it
        // console.log('attracted to: ' + a.ws);
        var f = a.calculateAttraction(this); // console.log(f);

        this.applyForce(f);
      }
    }
  };
}
/*!
 * aows
 * 
 * 
 * @author Lucas Lorenzo Pena <lucaslpena@gmail.com>
 * @version 0.1.0
 * Copyright 2019. CC-BY-NC-SA-4.0 licensed.
 */
var text1 = new Blotter.Text("Hello", {
  family: "Overpass Mono",
  size: 120,
  fill: "#171717"
});
var text2 = new Blotter.Text("Sup", {
  family: "Overpass Mono",
  size: 120,
  fill: "#171717"
});
var material = new Blotter.FliesMaterial();
var blotter1 = new Blotter(material, {
  texts: text1
});
var scope1 = blotter1.forText(text1);
scope1.appendTo(document.body); // var blotter2 = new Blotter(material, { texts : text2 });
// var scope2 = blotter2.forText(text2);
// scope2.appendTo(document.body);

setTimeout(function () {
  var element = $('.b-canvas').detach();
  $('.s00').append(element);
}, 2000);
/*!
 * aows
 * 
 * 
 * @author Lucas Lorenzo Pena <lucaslpena@gmail.com>
 * @version 0.1.0
 * Copyright 2019. CC-BY-NC-SA-4.0 licensed.
 */
var particles = [];
var limit = 10;
var imgs = [];
var weaksignals = [];
var keywords = [];
var attractors = [];
var jsonData = {};
var padding = 100;
var grid = 3;

function preload() {
  var jsonFile = "../data/fromspreadsheet-1.json";
  jsonData = loadJSON(jsonFile);
  console.log(jsonData);
}

var cnv;

var atlasObj = function (weaksignal, keyword) {
  this.kw = keyword;
  this.ws = weaksignal;
};

function centerCanvas() {
  cnv = createCanvas(windowWidth, windowHeight);
  var x = (windowWidth - width) / 2;
  var y = (windowHeight - height) / 2;
  cnv.position(x, y);
}

function windowResized() {
  centerCanvas();
}

function setup() {
  centerCanvas();
  setupWeakSignals();
  textFont("Overpass Mono");
  frameRate(60);
  weaksignals.forEach(function (ws, i) {
    keywords[0].forEach(function (kw, i) {
      var atls = new atlasObj(ws, kw);
      console.log(atls);
      particles.push(new Particle(random(50, width - 50), random(50, height - 50), {
        ws: ws,
        kw: kw
      }));
    });
  });
}

function draw() {
  background('#000');

  for (var i = 0; i < particles.length; i++) {
    particles[i].applyGravity(); // particles[i].separate(particles);
    // particles[i].separate(attractors);

    particles[i].update();
    particles[i].display();
  }

  fill(100);
  textSize(32);
  fill(255);
  attractors.forEach(function (a) {
    a.update();
    a.display();
  });
}

console.log('hello' + 'world'.repeat(3));

function setupWeakSignals() {
  //clipping keyword list to random selected words until wordCount reached
  for (var i in jsonData) {
    var wordCount = 10;
    var newItems = [];
    var items, index, item;

    if (jsonData[i]["keywords"].length > wordCount) {
      for (var j = 0; j < wordCount; j++) {
        items = jsonData[i]["keywords"];
        index = Math.floor(Math.random() * items.length);
        item = items.splice(index, 1);
        newItems.push(item[0]); // console.log(item[0]);
      } // console.log(newItems);


      jsonData[i]["keywords"] = newItems.slice();
    }
  } // console.log('setup');
  // console.log(jsonData);


  var j = 0,
      k = 0;

  for (var i in jsonData) {
    console.log(j, k);
    attractors.push(new Attractor(jsonData[i]["name"], j, k));
    weaksignals.push(jsonData[i]["name"]);
    keywords.push(jsonData[i]["keywords"]);
    $(".s" + j + k).html(jsonData[i]["name"]);

    if (j == 2) {
      k++;
      j = -1;
    }

    j++;
  } // 3 * 3 grid

}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF0dHJhY3Rvci5qcyIsInBhcnRpY2xlLmpzIiwic2NyaXB0LmpzIiwic2tldGNoLmpzIl0sIm5hbWVzIjpbIkF0dHJhY3RvciIsIndlYWtzaWduYWwiLCJ4Q29yZCIsInlDb3JkIiwid3MiLCJsZW5ndGgiLCJ3aWR0aCIsInBhZGRpbmciLCJpbnRlcnZhbCIsImdyaWQiLCJjZW50ZXJYIiwiaGVpZ2h0IiwiY2VudGVyWSIsInBvcyIsImNyZWF0ZVZlY3RvciIsInZlbCIsImFjYyIsIm1hc3MiLCJHIiwic2NhbGVyIiwiY2FsY3VsYXRlQXR0cmFjdGlvbiIsInAiLCJmb3JjZSIsInA1IiwiVmVjdG9yIiwic3ViIiwiZGlzdGFuY2UiLCJtYWciLCJjb25zdHJhaW4iLCJub3JtYWxpemUiLCJzdHJlbmd0aCIsIm11bHQiLCJhcHBseUZvcmNlIiwiZiIsImNvcHkiLCJkaXYiLCJhZGQiLCJ1cGRhdGUiLCJlZGdlcyIsInNldCIsImRpc3BsYXkiLCJwdXNoIiwic3Ryb2tlIiwidGV4dEFsaWduIiwiQ0VOVEVSIiwidGV4dCIsIngiLCJ5IiwicG9wIiwiUGFydGljbGUiLCJhIiwiYXRsYXMiLCJyYW5kb20iLCJwcmV2aW91c1ZlbCIsIm1heFNwZWVkIiwidGhldGEiLCJzaXplIiwic3Bhd24iLCJsaW1pdCIsImhlYWRpbmciLCJyYWRpYW5zIiwiciIsInRyYW5zbGF0ZSIsInRleHRTaXplIiwia3ciLCJzZXBhcmF0ZSIsInZlaGljbGVzIiwiZGVzaXJlZHNlcGFyYXRpb24iLCJzdW0iLCJjb3VudCIsImkiLCJkIiwiZGlzdCIsImRpZmYiLCJzdGVlciIsInZlbG9jaXR5IiwibWF4Zm9yY2UiLCJvYmoiLCJhcHBseUdyYXZpdHkiLCJhdHRyYWN0b3JzIiwidGV4dDEiLCJCbG90dGVyIiwiVGV4dCIsImZhbWlseSIsImZpbGwiLCJ0ZXh0MiIsIm1hdGVyaWFsIiwiRmxpZXNNYXRlcmlhbCIsImJsb3R0ZXIxIiwidGV4dHMiLCJzY29wZTEiLCJmb3JUZXh0IiwiYXBwZW5kVG8iLCJkb2N1bWVudCIsImJvZHkiLCJzZXRUaW1lb3V0IiwiZWxlbWVudCIsIiQiLCJkZXRhY2giLCJhcHBlbmQiLCJwYXJ0aWNsZXMiLCJpbWdzIiwid2Vha3NpZ25hbHMiLCJrZXl3b3JkcyIsImpzb25EYXRhIiwicHJlbG9hZCIsImpzb25GaWxlIiwibG9hZEpTT04iLCJjb25zb2xlIiwibG9nIiwiY252IiwiYXRsYXNPYmoiLCJrZXl3b3JkIiwiY2VudGVyQ2FudmFzIiwiY3JlYXRlQ2FudmFzIiwid2luZG93V2lkdGgiLCJ3aW5kb3dIZWlnaHQiLCJwb3NpdGlvbiIsIndpbmRvd1Jlc2l6ZWQiLCJzZXR1cCIsInNldHVwV2Vha1NpZ25hbHMiLCJ0ZXh0Rm9udCIsImZyYW1lUmF0ZSIsImZvckVhY2giLCJhdGxzIiwiZHJhdyIsImJhY2tncm91bmQiLCJyZXBlYXQiLCJ3b3JkQ291bnQiLCJuZXdJdGVtcyIsIml0ZW1zIiwiaW5kZXgiLCJpdGVtIiwiaiIsIk1hdGgiLCJmbG9vciIsInNwbGljZSIsInNsaWNlIiwiayIsImh0bWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsU0FBU0EsU0FBVCxDQUFtQkMsVUFBbkIsRUFBK0JDLEtBQS9CLEVBQXNDQyxLQUF0QyxFQUE2QztBQUN6QyxPQUFLQyxFQUFMLEdBQVVILFVBQVY7QUFDQSxNQUFJSSxNQUFNLEdBQUdDLEtBQUssR0FBRyxJQUFFQyxPQUF2QjtBQUNBLE1BQUlDLFFBQVEsR0FBSUgsTUFBTSxHQUFHSSxJQUF6QjtBQUNBLE1BQUlDLE9BQU8sR0FBR0gsT0FBTyxHQUFHQyxRQUFRLElBQUlOLEtBQUssR0FBQyxDQUFWLENBQWhDO0FBQ0FRLEVBQUFBLE9BQU8sR0FBR0EsT0FBTyxHQUFHRixRQUFRLEdBQUMsQ0FBN0I7QUFDQUgsRUFBQUEsTUFBTSxHQUFHTSxNQUFNLEdBQUcsSUFBRUosT0FBcEI7QUFDQUMsRUFBQUEsUUFBUSxHQUFJSCxNQUFNLEdBQUdJLElBQXJCO0FBQ0EsTUFBSUcsT0FBTyxHQUFHTCxPQUFPLEdBQUdD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QVAyQyxDQVE1Qzs7O0FBQ0E1QixNQUFBQSxRQUFRLENBQUNsQyxDQUFELENBQVIsQ0FBWSxVQUFaLElBQTBCMkQsUUFBUSxDQUFDUSxLQUFULEVBQTFCO0FBQ0g7QUFDSixHQWxCc0IsQ0FxQnZCO0FBQ0E7OztBQUVBLE1BQUlKLENBQUMsR0FBRyxDQUFSO0FBQUEsTUFBV0ssQ0FBQyxHQUFHLENBQWY7O0FBQ0EsT0FBSyxJQUFJcEUsQ0FBVCxJQUFja0MsUUFBZCxFQUF1QjtBQUNuQkksSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVl3QixDQUFaLEVBQWNLLENBQWQ7QUFDQTNELElBQUFBLFVBQVUsQ0FBQ3RDLElBQVgsQ0FBZ0IsSUFBSXpDLFNBQUosQ0FBY3dHLFFBQVEsQ0FBQ2xDLENBQUQsQ0FBUixDQUFZLE1BQVosQ0FBZCxFQUFtQytELENBQW5DLEVBQXNDSyxDQUF0QyxDQUFoQjtBQUNBcEMsSUFBQUEsV0FBVyxDQUFDN0QsSUFBWixDQUFpQitELFFBQVEsQ0FBQ2xDLENBQUQsQ0FBUixDQUFZLE1BQVosQ0FBakI7QUFDQWlDLElBQUFBLFFBQVEsQ0FBQzlELElBQVQsQ0FBYytELFFBQVEsQ0FBQ2xDLENBQUQsQ0FBUixDQUFZLFVBQVosQ0FBZDtBQUNBMkIsSUFBQUEsQ0FBQyxDQUFFLE9BQU9vQyxDQUFSLEdBQVdLLENBQVosQ0FBRCxDQUFnQkMsSUFBaEIsQ0FBcUJuQyxRQUFRLENBQUNsQyxDQUFELENBQVIsQ0FBWSxNQUFaLENBQXJCOztBQUNBLFFBQUkrRCxDQUFDLElBQUksQ0FBVCxFQUFXO0FBQ1BLLE1BQUFBLENBQUM7QUFDREwsTUFBQUEsQ0FBQyxHQUFHLENBQUMsQ0FBTDtBQUNIOztBQUNEQSxJQUFBQSxDQUFDO0FBQ0osR0FwQ3NCLENBc0N2Qjs7QUFDSCIsImZpbGUiOiJzY3JpcHRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gQXR0cmFjdG9yKHdlYWtzaWduYWwsIHhDb3JkLCB5Q29yZCkge1xuICAgIHRoaXMud3MgPSB3ZWFrc2lnbmFsO1xuICAgIHZhciBsZW5ndGggPSB3aWR0aCAtIDIqcGFkZGluZztcbiAgICB2YXIgaW50ZXJ2YWwgPSAobGVuZ3RoIC8gZ3JpZCk7XG4gICAgdmFyIGNlbnRlclggPSBwYWRkaW5nICsgaW50ZXJ2YWwgKiAoeENvcmQrMSk7XG4gICAgY2VudGVyWCA9IGNlbnRlclggLSBpbnRlcnZhbC8yO1xuICAgIGxlbmd0aCA9IGhlaWdodCAtIDIqcGFkZGluZztcbiAgICBpbnRlcnZhbCA9IChsZW5ndGggLyBncmlkKTtcbiAgICB2YXIgY2VudGVyWSA9IHBhZGRpbmcgKyBpbnRlcnZhbCAqICh5Q29yZCsxKTtcbiAgICBjZW50ZXJZID0gY2VudGVyWSAtIGludGVydmFsLzI7XG5cbiAgICB0aGlzLnBvcyA9IGNyZWF0ZVZlY3RvcihjZW50ZXJYLCBjZW50ZXJZKTtcbiAgICB0aGlzLnZlbCA9IGNyZWF0ZVZlY3RvcigwLDApO1xuICAgIHRoaXMuYWNjID0gY3JlYXRlVmVjdG9yKDAsMCk7XG5cbiAgICB0aGlzLm1hc3MgPSA2O1xuICAgIHRoaXMuRyA9IDE1OyAvL3dhcyA4MFxuICAgIHRoaXMuc2NhbGVyID0gNTtcblxuICAgIHRoaXMuY2FsY3VsYXRlQXR0cmFjdGlvbiA9IGZ1bmN0aW9uKHApe1xuICAgICAgICAvL2NhbGN1bGF0ZSBkaXJlY3Rpb24gb2YgZm9yY2VcbiAgICAgICAgdmFyIGZvcmNlID0gcDUuVmVjdG9yLnN1Yih0aGlzLnBvcywgcC5wb3MpO1xuXG4gICAgICAgIC8vZGlzdGFuY2UgYmV0d2VlbiBvYmplY3RzXG4gICAgICAgIHZhciBkaXN0YW5jZSA9IGZvcmNlLm1hZygpO1xuXG4gICAgICAgIC8vbGltaXQgdmVjdG9yIHRvIGVsaW1pbmF0ZSBleHRyZW1lIHZhbHVlcyBhdCB2ZXJ5IGNsb3NlIG9yIHZlcnkgZmFyXG4gICAgICAgIC8vIGRpc3RhbmNlID0gY29uc3RyYWluKGRpc3RhbmNlLDIwLDI1KTtcbiAgICAgICAgZGlzdGFuY2UgPSBjb25zdHJhaW4oZGlzdGFuY2UsNTAsNTUpO1xuICAgICAgICAvL05vdCByZWFsbHkgaW1wb3J0YW50IGJ1dCBpcyB3aGF0IGl0IGlzIHRvIGdldCBkaXJlY3Rpb25cbiAgICAgICAgZm9yY2Uubm9ybWFsaXplKCk7XG5cbiAgICAgICAgLy9jYWxjdWxhdGUgZ3Jhdml0YXRpb25hbCBmcm9tIG1hZ25paXR1ZGVcbiAgICAgICAgdmFyIHN0cmVuZ3RoID0gKHRoaXMuRyAqIHRoaXMubWFzcyAqIHAubWFzcykgLyAoZGlzdGFuY2UgKiBkaXN0YW5jZSk7XG5cbiAgICAgICAgLy9nZXQgZm9yY2UgdmVjdG9yIC0tPiBtYWduaXR1ZGUgKiBkaXJlY3Rpb25cbiAgICAgICAgZm9yY2UubXVsdChzdHJlbmd0aCk7XG4gICAgICAgIC8vdmFyIGZvcmNlO1xuICAgICAgICByZXR1cm4gZm9yY2U7XG4gICAgfVxuXG4gICAgdGhpcy5hcHBseUZvcmNlID0gZnVuY3Rpb24oZm9yY2Upe1xuICAgICAgICAvLyBBID0gRiAvTVxuICAgICAgICB2YXIgZiA9IGZvcmNlLmNvcHkoKTtcbiAgICAgICAgZi5kaXYodGhpcy5tYXNzKTtcbiAgICAgICAgdGhpcy5hY2MuYWRkKGYpO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5lZGdlcygpO1xuICAgICAgICB0aGlzLnZlbC5hZGQodGhpcy5hY2MpO1xuICAgICAgICB0aGlzLnBvcy5hZGQodGhpcy52ZWwpO1xuICAgICAgICB0aGlzLmFjYy5zZXQoMCwwKTtcbiAgICB9XG5cbiAgICB0aGlzLmRpc3BsYXkgPSBmdW5jdGlvbigpe1xuICAgICAgICBwdXNoKCk7XG4gICAgICAgIC8vIGZpbGwoMzAsMjUsMjApO1xuICAgICAgICBzdHJva2UoMzAsMjUsMzApO1xuICAgICAgICAvLyBlbGxpcHNlKHRoaXMucG9zLngsIHRoaXMucG9zLnksIHRoaXMubWFzcyAqIHRoaXMuc2NhbGVyLCB0aGlzLm1hc3MgKiB0aGlzLnNjYWxlcik7XG4gICAgICAgIC8vIGZpbGwoMzAsMjUsMjApO1xuICAgICAgICB0ZXh0QWxpZ24oQ0VOVEVSLCBDRU5URVIpO1xuICAgICAgICB0ZXh0KHRoaXMud3MsIHRoaXMucG9zLngsIHRoaXMucG9zLnkpO1xuICAgICAgICBwb3AoKTtcbiAgICB9XG5cbiAgICB0aGlzLmVkZ2VzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgaWYgKHRoaXMucG9zLnkgPiBoZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMudmVsLnkgKj0gLTE7XG4gICAgICAgICAgICB0aGlzLnBvcyA9IGNyZWF0ZVZlY3Rvcih3aWR0aC8yLCBoZWlnaHQvMik7XG4gICAgICAgICAgICB0aGlzLnZlbCA9IGNyZWF0ZVZlY3RvcigwLDApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBvcy54ID4gd2lkdGgpIHtcbiAgICAgICAgICAgIHRoaXMudmVsLnggKj0gLTE7XG4gICAgICAgICAgICB0aGlzLnBvcyA9IGNyZWF0ZVZlY3Rvcih3aWR0aC8yLCBoZWlnaHQvMik7XG4gICAgICAgICAgICB0aGlzLnZlbCA9IGNyZWF0ZVZlY3RvcigwLDApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBvcy54IDwgMCkge1xuICAgICAgICAgICAgdGhpcy52ZWwueCAqPSAtMTtcbiAgICAgICAgICAgIHRoaXMucG9zID0gY3JlYXRlVmVjdG9yKHdpZHRoLzIsIGhlaWdodC8yKTtcbiAgICAgICAgICAgIHRoaXMudmVsID0gY3JlYXRlVmVjdG9yKDAsMCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucG9zLnkgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLnZlbC54ICo9IC0xO1xuICAgICAgICAgICAgdGhpcy5wb3MgPSBjcmVhdGVWZWN0b3Iod2lkdGgvMiwgaGVpZ2h0LzIpO1xuICAgICAgICAgICAgdGhpcy52ZWwgPSBjcmVhdGVWZWN0b3IoMCwwKTtcbiAgICAgICAgfVxuICAgIH1cblxufSIsImZ1bmN0aW9uIFBhcnRpY2xlKHgseSxhKXtcbiAgICB0aGlzLmF0bGFzID0gYTtcblxuICAgIHRoaXMucG9zID0gY3JlYXRlVmVjdG9yKHgsIHkpO1xuICAgIHRoaXMudmVsID0gY3JlYXRlVmVjdG9yKHJhbmRvbSgtMywzKSxyYW5kb20oLTMsMykpO1xuICAgIHRoaXMuYWNjID0gY3JlYXRlVmVjdG9yKDAsLTgpO1xuXG4gICAgLy8gdGhpcy52ZWwgPSBjcmVhdGVWZWN0b3IoMCwwKTtcbiAgICAvLyB0aGlzLmFjYyA9IGNyZWF0ZVZlY3RvcigwLDApO1xuXG4gICAgdGhpcy5tYXNzID0gMTA7XG4gICAgdGhpcy5HID0gNTtcbiAgICB0aGlzLnByZXZpb3VzVmVsID0gY3JlYXRlVmVjdG9yKDAsMCk7XG4gICAgdGhpcy5tYXhTcGVlZCA9IDM7XG5cbiAgICB0aGlzLnRoZXRhID0gMC4wO1xuICAgIHRoaXMuc2l6ZSA9IDIwO1xuICAgIC8vIHRoaXMubWF4Rm9yY2UgPSAxO1xuXG5cblxuICAgIHRoaXMuc3Bhd24gPSBmdW5jdGlvbigpe1xuXG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyB0aGlzLnNwYXduKCk7XG4gICAgICAgIHRoaXMuZWRnZXMoKTtcbiAgICAgICAgdGhpcy52ZWwuYWRkKHRoaXMuYWNjKTtcbiAgICAgICAgdGhpcy52ZWwubGltaXQodGhpcy5tYXhTcGVlZCk7XG4gICAgICAgIHRoaXMucG9zLmFkZCh0aGlzLnZlbCk7XG4gICAgICAgIHRoaXMuYWNjLnNldCgwLDApO1xuICAgIH1cblxuICAgIHRoaXMuZGlzcGxheSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciB0aGV0YSA9IHRoaXMudmVsLmhlYWRpbmcoKSArIHJhZGlhbnMoOTApO1xuICAgICAgICB0aGlzLnRoZXRhICs9ICh0aGlzLnZlbC54ICogdGhpcy52ZWwubWFnKCkpIC8gMjA7XG4gICAgICAgIHZhciByID0gNDtcbiAgICAgICAgcHVzaCgpO1xuICAgICAgICB0cmFuc2xhdGUodGhpcy5wb3MueCwgdGhpcy5wb3MueSk7XG4gICAgICAgIC8vIHJvdGF0ZSh0aGlzLnRoZXRhKTtcblxuICAgICAgICAvLyByZWN0KDAsMCx0aGlzLnNpemUsdGhpcy5zaXplKTtcbiAgICAgICAgdGV4dEFsaWduKENFTlRFUiwgQ0VOVEVSKTtcbiAgICAgICAgdGV4dFNpemUoMTUpO1xuICAgICAgICB0ZXh0KHRoaXMuYXRsYXMua3csIDAsMCk7XG4gICAgICAgIC8vIGlmICh0aGlzLnBhdXNlZCkgeyAvL3BhdXNlZFxuICAgICAgICAvL3ByaW50KCdwYXVzZWQnKTtcbiAgICAgICAgLy9wcmludCgnZnJvemVuJyk7XG4gICAgICAgIC8vIHRoaXMucGF1c2VkID0gZmFsc2U7XG4gICAgICAgIC8vIHRoaXMuZnJvemVuID0gdHJ1ZTtcbiAgICAgICAgLy8gdGhpcy5pbWcucGF1c2UoKTtcbiAgICAgICAgLy8gfVxuICAgICAgICAvLyBpZiAodGhpcy5pbWcubG9hZGVkKCkpe1xuICAgICAgICAvLyAgIGltYWdlKHRoaXMuaW1nLCB0aGlzLnNpemUvLTIsIHRoaXMuc2l6ZS8tMiwgdGhpcy5zaXplLCB0aGlzLnNpemUpO1xuICAgICAgICAvLyB9XG4gICAgICAgIHBvcCgpO1xuICAgIH1cblxuICAgIHRoaXMuZWRnZXMgPSBmdW5jdGlvbigpe1xuICAgICAgICBpZiAodGhpcy5wb3MueCA8IC10aGlzLnNpemUpIHRoaXMucG9zLnggPSB3aWR0aCt0aGlzLnNpemU7XG4gICAgICAgIGlmICh0aGlzLnBvcy55IDwgLXRoaXMuc2l6ZSkgdGhpcy5wb3MueSA9IGhlaWdodCt0aGlzLnNpemU7XG4gICAgICAgIGlmICh0aGlzLnBvcy54ID4gd2lkdGgrdGhpcy5zaXplKSB0aGlzLnBvcy54ID0gLXRoaXMuc2l6ZTtcbiAgICAgICAgaWYgKHRoaXMucG9zLnkgPiBoZWlnaHQrdGhpcy5zaXplKSB0aGlzLnBvcy55ID0gLXRoaXMuc2l6ZTtcbiAgICB9XG5cbiAgICB0aGlzLnNlcGFyYXRlID0gZnVuY3Rpb24odmVoaWNsZXMpIHtcbiAgICAgICAgdmFyIGRlc2lyZWRzZXBhcmF0aW9uID0gdGhpcy5zaXplKjEuMTtcbiAgICAgICAgdmFyIHN1bSA9IGNyZWF0ZVZlY3RvcigpO1xuICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZlaGljbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZCA9IHA1LlZlY3Rvci5kaXN0KHRoaXMucG9zLCB2ZWhpY2xlc1tpXS5wb3MpO1xuICAgICAgICAgICAgaWYgKChkID4gMCkgJiYgKGQgPCBkZXNpcmVkc2VwYXJhdGlvbikpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlmZiA9IHA1LlZlY3Rvci5zdWIodGhpcy5wb3MsIHZlaGljbGVzW2ldLnBvcyk7XG4gICAgICAgICAgICAgICAgZGlmZi5ub3JtYWxpemUoKTtcbiAgICAgICAgICAgICAgICBkaWZmLmRpdihkKTtcbiAgICAgICAgICAgICAgICBzdW0uYWRkKGRpZmYpO1xuICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvdW50ID4gMCkge1xuICAgICAgICAgICAgc3VtLmRpdihjb3VudCk7XG4gICAgICAgICAgICBzdW0ubm9ybWFsaXplKCk7XG4gICAgICAgICAgICBzdW0ubXVsdCh0aGlzLm1heFNwZWVkICogMik7XG4gICAgICAgICAgICB2YXIgc3RlZXIgPSBwNS5WZWN0b3Iuc3ViKHN1bSwgdGhpcy52ZWxvY2l0eSk7XG4gICAgICAgICAgICBzdGVlci5saW1pdCh0aGlzLm1heGZvcmNlKTtcbiAgICAgICAgICAgIHRoaXMuYXBwbHlGb3JjZShzdGVlcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmFwcGx5Rm9yY2UgPSBmdW5jdGlvbihmb3JjZSkge1xuICAgICAgICB2YXIgZiA9IGZvcmNlLmNvcHkoKTtcbiAgICAgICAgZi5kaXYodGhpcy5tYXNzKTtcbiAgICAgICAgdGhpcy5hY2MuYWRkKGYpO1xuICAgIH1cblxuICAgIC8vY2FsY3VsYXRlIGF0dHJhY3Rpb25cbiAgICB0aGlzLmNhbGN1bGF0ZUF0dHJhY3Rpb24gPSBmdW5jdGlvbihvYmope1xuICAgICAgICAvL2NhbGN1bGF0ZSBkaXJlY3Rpb24gb2YgZm9yY2VcbiAgICAgICAgdmFyIGZvcmNlID0gcDUuVmVjdG9yLnN1Yih0aGlzLnBvcywgb2JqLnBvcyk7XG5cbiAgICAgICAgLy9kaXN0YW5jZSBiZXR3ZWVuIG9iamVjdHNcbiAgICAgICAgdmFyIGRpc3RhbmNlID0gZm9yY2UubWFnKCk7XG4gICAgICAgIC8vbGltaXQgdmVjdG9yIHRvIGVsaW1pbmF0ZSBleHRyZW1lIHZhbHVlcyBhdCB2ZXJ5IGNsb3NlIG9yIHZlcnkgZmFyXG4gICAgICAgIC8vZGlzdGFuY2UgPSBjb25zdHJhaW4oZGlzdGFuY2UsMjAsMjUpO1xuICAgICAgICAvL05vdCByZWFsbHkgaW1wb3J0YW50IGJ1dCBpcyB3aGF0IGl0IGlzIHRvIGdldCBkaXJlY3Rpb25cbiAgICAgICAgZm9yY2Uubm9ybWFsaXplKCk7XG5cbiAgICAgICAgLy9jYWxjdWxhdGUgZ3Jhdml0YXRpb25hbCBmcm9tIG1hZ25paXR1ZGVcbiAgICAgICAgdmFyIHN0cmVuZ3RoID0gKHRoaXMuRyAqIHRoaXMubWFzcyAqIG9iai5tYXNzKSAvIChkaXN0YW5jZSAqIGRpc3RhbmNlKTtcblxuICAgICAgICAvL2dldCBmb3JjZSB2ZWN0b3IgLS0+IG1hZ25pdHVkZSAqIGRpcmVjdGlvblxuICAgICAgICBmb3JjZS5tdWx0KHN0cmVuZ3RoKTtcbiAgICAgICAgLy92YXIgZm9yY2U7XG4gICAgICAgIHJldHVybiBmb3JjZTtcbiAgICB9XG5cbiAgICB0aGlzLmFwcGx5R3Jhdml0eSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXR0cmFjdG9ycy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB2YXIgYSA9IGF0dHJhY3RvcnNbaV07XG4gICAgICAgICAgICBpZiAoYS53cyA9PT0gdGhpcy5hdGxhcy53cyl7IC8vZ2V0IGV2ZXJ5b25lIGFwcGxpZWQgdG8gYW5kIGF0dHJhY3QgdG8gaXRcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnYXR0cmFjdGVkIHRvOiAnICsgYS53cyk7XG4gICAgICAgICAgICAgICAgdmFyIGYgPSBhLmNhbGN1bGF0ZUF0dHJhY3Rpb24odGhpcyk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZik7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseUZvcmNlKGYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59IiwidmFyIHRleHQxID0gbmV3IEJsb3R0ZXIuVGV4dChcIkhlbGxvXCIsIHtcbiAgICBmYW1pbHkgOiBcIk92ZXJwYXNzIE1vbm9cIixcbiAgICBzaXplIDogMTIwLFxuICAgIGZpbGwgOiBcIiMxNzE3MTdcIlxufSk7XG5cbnZhciB0ZXh0MiA9IG5ldyBCbG90dGVyLlRleHQoXCJTdXBcIiwge1xuICAgIGZhbWlseSA6IFwiT3ZlcnBhc3MgTW9ub1wiLFxuICAgIHNpemUgOiAxMjAsXG4gICAgZmlsbCA6IFwiIzE3MTcxN1wiXG59KTtcblxudmFyIG1hdGVyaWFsID0gbmV3IEJsb3R0ZXIuRmxpZXNNYXRlcmlhbCgpO1xuXG52YXIgYmxvdHRlcjEgPSBuZXcgQmxvdHRlcihtYXRlcmlhbCwgeyB0ZXh0cyA6IHRleHQxIH0pO1xudmFyIHNjb3BlMSA9IGJsb3R0ZXIxLmZvclRleHQodGV4dDEpO1xuc2NvcGUxLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpO1xuXG4vLyB2YXIgYmxvdHRlcjIgPSBuZXcgQmxvdHRlcihtYXRlcmlhbCwgeyB0ZXh0cyA6IHRleHQyIH0pO1xuLy8gdmFyIHNjb3BlMiA9IGJsb3R0ZXIyLmZvclRleHQodGV4dDIpO1xuLy8gc2NvcGUyLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpO1xuXG5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgdmFyIGVsZW1lbnQgPSAkKCcuYi1jYW52YXMnKS5kZXRhY2goKTtcbiAgICAkKCcuczAwJykuYXBwZW5kKGVsZW1lbnQpO1xufSwyMDAwKTsiLCJ2YXIgcGFydGljbGVzID0gW107XG52YXIgbGltaXQgPSAxMDtcbnZhciBpbWdzID0gW107XG52YXIgd2Vha3NpZ25hbHMgPSBbXTtcbnZhciBrZXl3b3JkcyA9IFtdO1xudmFyIGF0dHJhY3RvcnMgPSBbXTtcbnZhciBqc29uRGF0YSA9IHt9O1xudmFyIHBhZGRpbmcgPSAxMDA7XG52YXIgZ3JpZCA9IDM7XG5cblxuZnVuY3Rpb24gcHJlbG9hZCgpIHtcbiAgICB2YXIganNvbkZpbGUgPSBcIi4uL2RhdGEvZnJvbXNwcmVhZHNoZWV0LTEuanNvblwiO1xuICAgIGpzb25EYXRhID0gbG9hZEpTT04oanNvbkZpbGUpO1xuICAgIGNvbnNvbGUubG9nKGpzb25EYXRhKTtcbn1cblxudmFyIGNudjtcblxuXG52YXIgYXRsYXNPYmogPSBmdW5jdGlvbih3ZWFrc2lnbmFsLCBrZXl3b3JkKXtcbiAgICB0aGlzLmt3ID0ga2V5d29yZDtcbiAgICB0aGlzLndzID0gd2Vha3NpZ25hbDtcbn07XG5cbmZ1bmN0aW9uIGNlbnRlckNhbnZhcygpIHtcbiAgICBjbnYgPSBjcmVhdGVDYW52YXMod2luZG93V2lkdGgsIHdpbmRvd0hlaWdodCk7XG4gICAgdmFyIHggPSAod2luZG93V2lkdGggLSB3aWR0aCkgLyAyO1xuICAgIHZhciB5ID0gKHdpbmRvd0hlaWdodCAtIGhlaWdodCkgLyAyO1xuICAgIGNudi5wb3NpdGlvbih4LCB5KTtcbn1cblxuZnVuY3Rpb24gd2luZG93UmVzaXplZCgpIHtcbiAgICBjZW50ZXJDYW52YXMoKTtcbn1cblxuZnVuY3Rpb24gc2V0dXAoKSB7XG4gICAgY2VudGVyQ2FudmFzKCk7XG4gICAgc2V0dXBXZWFrU2lnbmFscygpO1xuICAgIHRleHRGb250KFwiT3ZlcnBhc3MgTW9ub1wiKTtcbiAgICBmcmFtZVJhdGUoNjApO1xuXG4gICAgd2Vha3NpZ25hbHMuZm9yRWFjaChmdW5jdGlvbih3cywgaSl7XG4gICAgICAgIGtleXdvcmRzWzBdLmZvckVhY2goZnVuY3Rpb24oa3csIGkpe1xuICAgICAgICAgICAgdmFyIGF0bHMgPSBuZXcgYXRsYXNPYmood3MsIGt3KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGF0bHMpO1xuICAgICAgICAgICAgcGFydGljbGVzLnB1c2gobmV3IFBhcnRpY2xlKHJhbmRvbSg1MCwgd2lkdGggLSA1MCksIHJhbmRvbSg1MCwgaGVpZ2h0IC0gNTApLCB7d3M6d3MsIGt3Omt3fSkpO1xuICAgICAgICB9KTtcbiAgICB9KVxufVxuXG5mdW5jdGlvbiBkcmF3KCkge1xuICAgIGJhY2tncm91bmQoJyMwMDAnKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFydGljbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBhcnRpY2xlc1tpXS5hcHBseUdyYXZpdHkoKTtcbiAgICAgICAgLy8gcGFydGljbGVzW2ldLnNlcGFyYXRlKHBhcnRpY2xlcyk7XG4gICAgICAgIC8vIHBhcnRpY2xlc1tpXS5zZXBhcmF0ZShhdHRyYWN0b3JzKTtcbiAgICAgICAgcGFydGljbGVzW2ldLnVwZGF0ZSgpO1xuICAgICAgICBwYXJ0aWNsZXNbaV0uZGlzcGxheSgpO1xuICAgIH1cblxuICAgIGZpbGwoMTAwKTtcbiAgICB0ZXh0U2l6ZSgzMik7XG4gICAgZmlsbCgyNTUpO1xuICAgIGF0dHJhY3RvcnMuZm9yRWFjaChmdW5jdGlvbihhKXtcbiAgICAgICAgYS51cGRhdGUoKTtcbiAgICAgICAgYS5kaXNwbGF5KCk7XG4gICAgfSk7XG59XG5cbmNvbnNvbGUubG9nKCdoZWxsbycrJ3dvcmxkJy5yZXBlYXQoMykpO1xuXG5mdW5jdGlvbiBzZXR1cFdlYWtTaWduYWxzKCl7XG5cbiAgICAvL2NsaXBwaW5nIGtleXdvcmQgbGlzdCB0byByYW5kb20gc2VsZWN0ZWQgd29yZHMgdW50aWwgd29yZENvdW50IHJlYWNoZWRcbiAgICBmb3IgKHZhciBpIGluIGpzb25EYXRhKXtcbiAgICAgICAgdmFyIHdvcmRDb3VudCA9IDEwO1xuICAgICAgICB2YXIgbmV3SXRlbXMgPSBbXTtcbiAgICAgICAgdmFyIGl0ZW1zLCBpbmRleCwgaXRlbTtcbiAgICAgICAgaWYgKGpzb25EYXRhW2ldW1wia2V5d29yZHNcIl0ubGVuZ3RoID4gd29yZENvdW50KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHdvcmRDb3VudDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaXRlbXMgPSBqc29uRGF0YVtpXVtcImtleXdvcmRzXCJdO1xuICAgICAgICAgICAgICAgIGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogaXRlbXMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBpdGVtID0gaXRlbXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICBuZXdJdGVtcy5wdXNoKGl0ZW1bMF0pO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGl0ZW1bMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cobmV3SXRlbXMpO1xuICAgICAgICAgICAganNvbkRhdGFbaV1bXCJrZXl3b3Jkc1wiXSA9IG5ld0l0ZW1zLnNsaWNlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vIGNvbnNvbGUubG9nKCdzZXR1cCcpO1xuICAgIC8vIGNvbnNvbGUubG9nKGpzb25EYXRhKTtcblxuICAgIHZhciBqID0gMCwgayA9IDA7XG4gICAgZm9yICh2YXIgaSBpbiBqc29uRGF0YSl7XG4gICAgICAgIGNvbnNvbGUubG9nKGosayk7XG4gICAgICAgIGF0dHJhY3RvcnMucHVzaChuZXcgQXR0cmFjdG9yKGpzb25EYXRhW2ldW1wibmFtZVwiXSwgaiwgaykpO1xuICAgICAgICB3ZWFrc2lnbmFscy5wdXNoKGpzb25EYXRhW2ldW1wibmFtZVwiXSk7XG4gICAgICAgIGtleXdvcmRzLnB1c2goanNvbkRhdGFbaV1bXCJrZXl3b3Jkc1wiXSk7XG4gICAgICAgICQoKFwiLnNcIiArIGopK2spLmh0bWwoanNvbkRhdGFbaV1bXCJuYW1lXCJdKTtcbiAgICAgICAgaWYgKGogPT0gMil7XG4gICAgICAgICAgICBrKys7XG4gICAgICAgICAgICBqID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgaisrO1xuICAgIH1cblxuICAgIC8vIDMgKiAzIGdyaWRcbn1cblxuXG4iXX0=
